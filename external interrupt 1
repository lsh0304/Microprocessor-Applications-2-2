#include <iom128v.h>
#include <macros.h>

void delay_m(unsigned int m);
char number[10] = {0x04,0x2F,0x18,0x09,0x23,0x41,0x40,0x07,0x00,0x01};
char cnt, flag;

void main(void)
{
    DDRD=0x7f;
    EICRB=0x02; // INT4 Falling Edge
    EIMSK=0x10; // INT4 Enable
    //SREG|=0x80; // 1000 0000
    SEI();

    PORTD=number[0];

    while(1){

        while(flag){
            cnt++;
            if(cnt==10) cnt=0;
            PORTD=number[cnt];
            delay_m(500);
        }
    }
}

#pragma interrupt_handler int4_isr:iv_INT4
void int4_isr(void)
{
    delay_m(200);
    flag=flag^1;
    EIFR=0x10;
}

void delay_m(unsigned int m)
{
    int i, j;
    for (i=0;i<m;i++){
        for (j=0;j<2100;j++){
            ;
        }
    }
}
